{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://destiny-evidence.github.io/taxonomy-builder/schemas/published/ontology.schema.json",
  "title": "Published Ontology",
  "description": "Domain model for a project: the ontology classes and the properties that link them to concept schemes or datatypes. Loaded on demand when the reader needs to display the domain model (e.g. graph visualisation, property tables). Served at /{project-id}/ontology.json.",
  "type": "object",
  "required": ["format_version", "project_id", "domain_classes", "properties"],
  "additionalProperties": false,
  "properties": {
    "format_version": {
      "type": "string",
      "const": "1.0",
      "description": "Schema version for forwards compatibility."
    },
    "project_id": {
      "type": "string",
      "format": "uuid",
      "description": "Project UUID. Matches the project in the sibling index.json."
    },
    "domain_classes": {
      "type": "array",
      "description": "OWL classes from the core ontology that can be extended with properties.",
      "items": {
        "type": "object",
        "required": ["uri", "label"],
        "additionalProperties": false,
        "properties": {
          "uri": {
            "type": "string",
            "format": "uri",
            "description": "Full URI of the ontology class."
          },
          "label": {
            "type": "string",
            "description": "Human-readable class label (e.g. \"Finding\", \"Investigation\")."
          },
          "comment": {
            "type": ["string", "null"],
            "description": "Description of the class from the ontology."
          }
        }
      }
    },
    "properties": {
      "type": "array",
      "description": "Property definitions linking domain classes to concept schemes or datatypes.",
      "items": {
        "type": "object",
        "required": [
          "id",
          "identifier",
          "label",
          "domain_class_uri",
          "cardinality",
          "required"
        ],
        "additionalProperties": false,
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Property UUID."
          },
          "identifier": {
            "type": "string",
            "description": "URI-safe identifier. Full property URI is computable from the project namespace and this identifier."
          },
          "label": {
            "type": "string",
            "description": "Human-readable property label."
          },
          "description": {
            "type": ["string", "null"],
            "description": "Coding guidance for data entry."
          },
          "domain_class_uri": {
            "type": "string",
            "format": "uri",
            "description": "URI of the ontology class this property applies to. Resolve label from the domain_classes array."
          },
          "range_scheme_id": {
            "type": ["string", "null"],
            "format": "uuid",
            "description": "UUID of the concept scheme providing values, or null if range is a datatype. Cross-reference with the schemes array in the project index."
          },
          "range_datatype": {
            "type": ["string", "null"],
            "description": "XSD datatype (e.g. \"xsd:integer\"), or null if range is a concept scheme."
          },
          "cardinality": {
            "type": "string",
            "enum": ["single", "multiple"],
            "description": "Whether the property accepts a single value or multiple values."
          },
          "required": {
            "type": "boolean",
            "description": "Whether the property is required for its domain class."
          }
        }
      }
    }
  }
}
