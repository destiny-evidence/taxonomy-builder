{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://destiny-evidence.github.io/taxonomy-builder/schemas/published/vocabulary.schema.json",
  "title": "Published Vocabulary",
  "description": "A single published vocabulary (concept scheme) containing all concepts and their relationships. Concepts are stored as a flat map keyed by UUID, with relationship references as ID arrays. The reader frontend builds tree views from the top_concepts list and broader references. Served at /{project-id}/{scheme-id}/{version-id}.json.",
  "type": "object",
  "required": ["format_version", "scheme_id", "concepts", "top_concepts"],
  "additionalProperties": false,
  "properties": {
    "format_version": {
      "type": "string",
      "const": "1.0",
      "description": "Schema version for forwards compatibility."
    },
    "scheme_id": {
      "type": "string",
      "format": "uuid",
      "description": "Concept scheme UUID. Full scheme metadata is available from the project and scheme indexes."
    },
    "concepts": {
      "type": "object",
      "description": "Map of concept UUID to concept data. Keyed by UUID for O(1) lookup.",
      "additionalProperties": {
        "type": "object",
        "required": ["pref_label"],
        "additionalProperties": false,
        "properties": {
          "pref_label": {
            "type": "string",
            "description": "Preferred label for the concept."
          },
          "definition": {
            "type": ["string", "null"],
            "description": "Concept definition."
          },
          "scope_note": {
            "type": ["string", "null"],
            "description": "Scope note clarifying the intended use of this concept."
          },
          "alt_labels": {
            "type": "array",
            "items": { "type": "string" },
            "default": [],
            "description": "Alternative labels (synonyms, abbreviations)."
          },
          "broader": {
            "type": "array",
            "items": { "type": "string", "format": "uuid" },
            "default": [],
            "description": "UUIDs of broader (parent) concepts. Empty for top concepts."
          },
          "related": {
            "type": "array",
            "items": { "type": "string", "format": "uuid" },
            "default": [],
            "description": "UUIDs of related concepts (symmetric SKOS related)."
          }
        }
      }
    },
    "top_concepts": {
      "type": "array",
      "items": { "type": "string", "format": "uuid" },
      "description": "UUIDs of root concepts (no broader relationships). Entry points for tree rendering."
    }
  }
}
